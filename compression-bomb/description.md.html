<p>Compression Bombs</p>

<p><em>Description</em></p>

<p>See <a href="http://cwe.mitre.org/data/definitions/409.html">CWE 409</a>. Also libpng has a <a href="http://libpng.sourceforge.net/decompression_bombs.html">great discussion</a></p>

<p>Similar to an XML bomb, compression bombs are primarily used for denial of service attacks by filling up RAM or hard disk space. Minimally, this crashes the process and causes denial of service. Crashes, if handled poorly, however, can also cause other integrity problems (e.g. data corrpution), or confidentiality problems (e.g. core dumps). </p>

<p>What is more challenging about compression bombs is how ubiquitous compression is, and how hard this is to validate. If you are doing input validation, then you probably need to decompress first, so your decompression library is on the front lines of your attack surface.</p>

<p><em>Example</em> </p>

<p><em>Mitigations</em>
  * Technically, a decompression library can mitigate this problem by keeping count of how many bytes have been decompressed and throwing an exception when it exceeds that limit (as is the mitigation with XML bombs). In practice, this feature  often does not exist in decompression libraries (sadly). Look for such limits in the libraries that you use.
  * Avoid inputs where an arbitrary number of rounds of compression are allowed (e.g. this is possible with HTTP Headers) 
  * Distrustful decomposition + strict system resource limits can mitigate this too. For example, a PNG file that gets server-side processing might want to do that processing in a separate process with tight memory consumption constraints. This adds complexity to your design too, and introduces concurrency complexities. </p>

<p><em>Notes</em>
  * Compression is everywhere. HTTP Response headers can be compressed at the web server-to-browser level (unbeknownst to wep app developers). PNG and JPEG files are susceptible to bombing. MS Office documents are simply zip files of XML. 
  * Testing for this is very easy - just create a bomb with blank data and compress it heavily. Some compression tools might prevent you from over-compressing, so look up the maximum ratios of your compression algorithms instead of just trusting the compression tool
  * Due to the super-high ratios achieved by modern compression bombing, it is NOT a feasible approach to simply limit the the compressed input size.</p>
