import re
import time
import sys
import signal

VULNERABLE_REGEX = "^(a+)+$"

def check_valid_input(s):
    pattern = re.compile(VULNERABLE_REGEX)

    start = time.time()
    matches = pattern.search(s)
    end = time.time() - start
    print(f"Time taken on {s}: {end:0.5f}, matches? {matches != None} ")
########### NEW CODE ##############
def handle_timeout(sig, frame):
    raise TimeoutError('took more than 5 seconds!')

signal.signal(signal.SIGALRM, handle_timeout)
signal.alarm(5) # tell OS: send SIGALARM in 5 seconds
###################################
check_valid_input(sys.argv[1])
